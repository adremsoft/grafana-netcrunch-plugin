var adrem;(function(adrem){"use strict";if(typeof window==="undefined"){adrem=global.adrem}var RemoteObjProxy=function(){function RemoteObjProxy(params,Map,SrvIntface,callback){this.Map=Map;var remoteObject,p=[Map.classId],method,self=this,defaultConverter;if(params!==undefined){p.push(params)}remoteObject=new SrvIntface({params:p,callback:callback});defaultConverter={getParams:function(params,info){var paramNames=info.params===undefined?[]:info.params.split(","),result=[];paramNames.forEach(function(p){result.push(params[p.trim()])});return result},getResult:function(res,info){var props,result,ix=0;function getResultObject(ix){var result={};props.forEach(function(p,i){if(ix+i<res.Result.length){result[p.trim()]=res.Result[ix+i]}});return result}if(info.result!==undefined){if(res.Result!=null){if(Array.isArray(res.Result)){props=info.result.split(",");if(res.Result.length>props.length){result=[];while(ix<res.Result.length){result.push(getResultObject(ix));ix+=props.length}}else{result=getResultObject(0)}}else{result=res.Result}}}else{result=res.Result}return result}};function createMethod(def){var converter=adrem.extend(defaultConverter,def.convert),methodCall=function(params,callback){if(typeof params==="function"){callback=params;params={}}if(def.default!=null){params=adrem.extend(params,def.default)}return remoteObject.request(def.id,converter.getParams(params,def),function(res){if(callback!=null){callback(converter.getResult(res,def))}})};methodCall["asTask"]=function(checkTime,params,callback){var task;if(typeof params==="function"){callback=params;params={}}if(def.default!=null){params=adrem.extend(params,def.default)}return remoteObject.request.asTask(checkTime,def.id,converter.getParams(params,def),function(status){if(status.finished){status.reply.Result=converter.getResult(status.reply,def)}if(callback!=null){callback(status)}})};return methodCall}for(method in Map.methods){if(Map.methods.hasOwnProperty(method)){self[method]=createMethod(Map.methods[method])}}}RemoteObjProxy.prototype.asStringListData=function(data,reversed,decodeValue){var result=[];reversed=reversed||true;data.forEach(function(s){var v=s.split("="),d={},name,val;name=reversed?v[1]:v[0];val=reversed?v[0]:v[1];if(typeof decodeValue=="function"){val=decodeValue(val)}d[name]=val;result.push(d)});return result};RemoteObjProxy.prototype.asParamList=function(data){return this.asStringListData(data,false)};return RemoteObjProxy}();adrem.RemoteObjProxy=RemoteObjProxy})(adrem||(adrem={}));
