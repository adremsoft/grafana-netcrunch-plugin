{"version":3,"sources":["../../../../../../src/datasource/services/netCrunchAPI/netCrunchConnection/networkData/networkMap.js"],"names":["PRIVATE_PROPERTIES","local","Symbol","values","NetCrunchNetworkMap","mapRec","addNodesToNetworkMap","HostMapData","i","len","nodeData","nodesId","push","parseInt","getValues","netId","NetIntId","parentId","NetworkData","isNaN","isFolder","MapClassTag","Array","isArray","mapsData","maps","map","id","children","networkMap","isUnique","every","child","addArrayToSet","array","set","forEach","add","item","nodesSet","Set","allNodesId","from","DisplayName","sortMapsByName","first","second","displayName","localeCompare","createMapList","innerLevel","parentIndex","mapList","sort","currentIndex","length","concat"],"mappings":"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","file":"networkMap.js","sourcesContent":["/**\n * @license\n * Copyright AdRem Software. All Rights Reserved.\n *\n * Use of this source code is governed by an Apache License, Version 2.0 that can be\n * found in the LICENSE file.\n */\n\nconst\n  PRIVATE_PROPERTIES = {\n    local: Symbol('local'),\n    values: Symbol('values')\n  };\n\nclass NetCrunchNetworkMap {\n\n  constructor(mapRec) {\n\n    /* eslint-disable no-param-reassign */\n\n    function addNodesToNetworkMap(local, values) {\n      if (values.HostMapData != null) {\n        for (let i = 1, len = values.HostMapData[0]; i <= len; i += 1) {\n          const nodeData = values.HostMapData[i];\n          if ((nodeData[0] === 0) || (nodeData[0] === 5)) {\n            local.nodesId.push(parseInt(nodeData[1], 10));\n          }\n        }\n      }\n    }\n\n    function decodeNetworkMapData(local, values) {\n\n      local.netId = values.NetIntId || '';\n\n      local.parentId = (values.NetworkData != null) ? parseInt(values.NetworkData[0], 10) : '';\n      if (isNaN(local.parentId)) {\n        local.parentId = '';\n      }\n\n      local.isFolder = ((values.MapClassTag === 'dynfolder') ||\n                        ((values.NetworkData != null) && Array.isArray(values.NetworkData[1])));\n\n      if (local.isFolder) {\n        const mapsData = (values.NetworkData != null) ? values.NetworkData[1] : [];\n\n        if (Array.isArray(mapsData)) {                        // otherwise it can be empty object instead of empty array\n          local.maps = mapsData.map(id => parseInt(id, 10));\n        }\n\n        if (values.MapClassTag === 'fnet') {                  // Add nodes into physical segments map\n          addNodesToNetworkMap(local, values);\n        }\n      } else {\n        addNodesToNetworkMap(local, values);\n      }\n    }\n\n    /* eslint-enable no-param-reassign */\n\n    if (mapRec != null) {\n      this[PRIVATE_PROPERTIES.local] = mapRec.local;\n      this[PRIVATE_PROPERTIES.values] = mapRec.getValues();\n    } else {\n      this[PRIVATE_PROPERTIES.local] = {};\n      this[PRIVATE_PROPERTIES.values] = {};\n    }\n\n    this[PRIVATE_PROPERTIES.local].nodesId = [];\n    decodeNetworkMapData(this[PRIVATE_PROPERTIES.local], this[PRIVATE_PROPERTIES.values]);\n    this[PRIVATE_PROPERTIES.local].children = [];\n  }\n\n  get netId() {\n    return this[PRIVATE_PROPERTIES.local].netId;\n  }\n\n  get parentId() {\n    return this[PRIVATE_PROPERTIES.local].parentId;\n  }\n\n  get nodesId() {\n    return this[PRIVATE_PROPERTIES.local].nodesId;\n  }\n\n  get allNodesId() {\n    const nodesSet = new Set();\n\n    function addArrayToSet(array, set) {\n      array.forEach(item => set.add(item));\n      return set;\n    }\n\n    if (this.isFolder) {\n\n      if (this[PRIVATE_PROPERTIES.values].MapClassTag === 'fnet') {     // Add nodes into physical segment map\n        addArrayToSet(this.nodesId, nodesSet);\n      }\n\n      this.children.forEach((child) => {\n        addArrayToSet(child.allNodesId, nodesSet);\n      });\n\n    } else {\n      addArrayToSet(this.nodesId, nodesSet);\n    }\n\n    return Array.from(nodesSet);\n  }\n\n  get isFolder() {\n    return this[PRIVATE_PROPERTIES.local].isFolder;\n  }\n\n  get children() {\n    return this[PRIVATE_PROPERTIES.local].children;\n  }\n\n  get displayName() {\n    return this[PRIVATE_PROPERTIES.values].DisplayName || '';\n  }\n\n  get allChildren() {\n\n    function sortMapsByName(first, second) {\n      return first.displayName.localeCompare(second.displayName);\n    }\n\n    function createMapList(map, innerLevel, parentIndex) {\n      let mapList = [];\n\n      map.children\n        .sort(sortMapsByName)\n        .forEach((child) => {\n          mapList.push({\n            map: child,\n            innerLevel,\n            parentIndex\n          });\n\n          if ((map.isFolder) && (innerLevel <= 2)) {\n            const currentIndex = isNaN(parentIndex) ? mapList.length - 1 : parentIndex + mapList.length;\n            mapList = mapList.concat(createMapList(child, innerLevel + 1, currentIndex));\n          }\n        });\n      return mapList;\n    }\n\n    return createMapList(this, 1, 'root');\n  }\n\n  addChild(networkMap) {\n    const isUnique = this.children.every(child => (child.netId !== networkMap.netId));\n    if (isUnique === true) {\n      this.children.push(networkMap);\n    }\n  }\n\n}\n\nexport {\n  NetCrunchNetworkMap\n};\n"]}